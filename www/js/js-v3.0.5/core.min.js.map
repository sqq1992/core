{"version":3,"sources":["core.clean.js"],"names":["Array","prototype","filter","fun","len","this","length","TypeError","res","thisp","arguments","i","val","call","push","forEach","action","that","n","Function","bind","oThis","aArgs","slice","fToBind","fNOP","fBound","apply","concat","String","trim","replace","map","callback","thisArg","T","A","k","O","Object","kValue","mappedValue","indexOf","elt","from","Number","Math","ceil","floor","window","app","version","load","cache","route","control","connect","util","_cache","addParams","type","params","hasOwnProperty","getParams","key","result","_","isUndefined","undefined","removeParams","isArray","config","o","$","_getJSONSingle","data","_data","JSON","stringify","_getJSONList","item","arr","clone","_getJSONLists","str","lastItem","temp","_filterAd","_getDataType","_type","size","_getUrlDataType","url","value","element","dataType","_url","isObject","api","_delQueue","ajQueue","elem","index","isEqual","splice","_whereQueue","_addQueue","jqXHR","success","obj","xhr","cb","_addQueueCb","ajax","udt","context","async","headers","X-HTTP-Method-Override","Accept","Content-Type","beforeSend","num","abort","json","sessionTimeout","location","href","error","setts","complete","socket","jQuery","addCache","status","reduceCache","getRender","getDestroy","getHas","updateModules","hashSearch","diffPath","modules","handler","_render","_destroy","_has","_temp","getHashSearchObj","fn","destroy","use","render","j","isUpdate","_dependence","dependence","update","win","_getGid","gid","getCurrentNode","document","currentScript","arrScript","getElementsByTagName","readyState","path","getCurrentPath","src","Error","repStr","doc","stack","a","b","c","e","opera","match","join","split","pop","node","querySelector","getAttribute","_loadJs","option","d","extend","charset","docCharset","createElement","id","idPrefix","onload","onerror","onreadystatechange","test","head","appendChild","getCurSrc","currentlyAddingScript","interactiveScript","scripts","script","isUrl","search","fixUrl","getUrl","rootUrl","lastIndexOf","fixSuffix","suffix","reg","RegExp","replacePath","ids","getDepUrl","pathId","baseUrl","getIdUrl","require","curExecModName","moduleMap","exports","fixPath","docUrl","BASEURL","DOCURL","execMod","modName","exp","modMap","execComplete","oncomplete","loadMod","isFunction","deps","depsCount","param","define","name","toString","commentRegExp","cjsRequireRegExp","dep","debug","getData","documentElement","PB","_storage","subscribe","types","functions","isString","unSubscribe","publish","constructor","get","pb","routes","mode","root","options","history","clearSlashes","add","re","mols","remove","flush","check","f","_path","getHashPath","_search","getSearchObj","listen","self","current","getHash","onhashchange","navigate","pushState","getHref","decodeURI","getProtocol","protocol","getHost","host","getHostName","hostname","getPort","encodeURI","port","getPathname","pathname","hash","getSearch","getAll","_hash","hashPath","setHref","setProtocol","setHost","setHostName","setPort","setPathname","setHash","setSearch","setHashSearch","object","hashArr","HASH","delHashSearch","arg","parseUrl","tmp","p","r","exec","isEqualHost","m","iO","jO","Stg","cookieExpires","isHasLocalStorage","localStorage","setItem","cookie","expires","getItem","del","parse","removeItem","storage"],"mappings":"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","file":"core.min.js","sourcesContent":["/**\r\n * @fileOverview\r\n * @author Crow\r\n * @version 0.0.1\r\n * @time 2016/2/24\r\n */\r\n\r\n\r\nif (!Array.prototype.filter) {\r\n    Array.prototype.filter = function(fun /*, thisp*/){\r\n        var len = this.length;\r\n        if (typeof fun != \"function\"){\r\n            throw new TypeError();\r\n        }\r\n        var res = new Array();\r\n        var thisp = arguments[1];\r\n        for (var i = 0; i < len; i++){\r\n            if (i in this){\r\n                var val = this[i]; // in case fun mutates this\r\n                if (fun.call(thisp, val, i, this)) {\r\n                    res.push(val);\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n}\r\n\r\nif (!Array.prototype.forEach) {\r\n    Array.prototype.forEach= function(action, that) {\r\n        for (var i= 0, n= this.length; i<n; i++)\r\n            if (i in this)\r\n                action.call(that, this[i], i, this);\r\n    };\r\n}\r\n\r\nif (!Function.prototype.bind) {\r\n    Function.prototype.bind = function (oThis) {\r\n        if (typeof this !== \"function\") {\r\n            throw new TypeError(\"Function.prototype.bind - what is trying to be bound is not callable\");\r\n        }\r\n        var aArgs = Array.prototype.slice.call(arguments, 1),\r\n            fToBind = this,\r\n            fNOP = function () {},\r\n            fBound = function () {\r\n                return fToBind.apply(this instanceof fNOP && oThis\r\n                        ? this\r\n                        : oThis,\r\n                    aArgs.concat(Array.prototype.slice.call(arguments)));\r\n            };\r\n        fNOP.prototype = this.prototype;\r\n        fBound.prototype = new fNOP();\r\n        return fBound;\r\n    };\r\n}\r\n\r\nif(!String.prototype.trim) {\r\n    String.prototype.trim = function() {\r\n        return this.replace(/^\\s+|\\s+$/g, '');\r\n    }\r\n}\r\n\r\n//http://stackoverflow.com/questions/18500942/array-map-function-not-supported-in-ie8-standards\r\nif (!Array.prototype.map) {\r\n    Array.prototype.map = function(callback, thisArg) {\r\n        var T, A, k;\r\n        if (this == null) {\r\n            throw new TypeError(\" this is null or not defined\");\r\n        }\r\n        var O = Object(this);\r\n        var len = O.length >>> 0;\r\n        if (typeof callback !== \"function\") {\r\n            throw new TypeError(callback + \" is not a function\");\r\n        }\r\n        if (thisArg) {\r\n            T = thisArg;\r\n        }\r\n        A = new Array(len);\r\n\r\n        k = 0;\r\n        while(k < len) {\r\n            var kValue, mappedValue;\r\n\r\n            if (k in O) {\r\n\r\n                kValue = O[ k ];\r\n                mappedValue = callback.call(T, kValue, k, O);\r\n                A[ k ] = mappedValue;\r\n            }\r\n            k++;\r\n        }\r\n        return A;\r\n    };\r\n}\r\n\r\n// http://www.cnblogs.com/JustRun1983/archive/2013/04/02/2996650.html\r\nif (!Array.prototype.indexOf) {\r\n    Array.prototype.indexOf = function(elt /*, from*/)\r\n    {\r\n        var len = this.length >>> 0;\r\n\r\n        var from = Number(arguments[1]) || 0;\r\n        from = (from < 0)\r\n            ? Math.ceil(from)\r\n            : Math.floor(from);\r\n        if (from < 0)\r\n            from += len;\r\n\r\n        for (; from < len; from++)\r\n        {\r\n            if (from in this &&\r\n                this[from] === elt)\r\n                return from;\r\n        }\r\n        return -1;\r\n    };\r\n}\r\n/**\r\n * @fileOverview\r\n * @author Crow\r\n * @version 0.0.1\r\n * @time 2015/11/3\r\n */\r\n/*global _*/\r\n(function (window) {\r\n    'use strict';\r\n    var app = {\r\n        version: '3.0.5'\r\n    };\r\n    // 加载\r\n    app.load = {};\r\n    // 缓存\r\n    app.cache = {};\r\n    // 路由\r\n    app.route = {};\r\n    // 控制\r\n    app.control = {};\r\n    // 通信\r\n    app.connect = {};\r\n    // 公共方法\r\n    app.util = {};\r\n\r\n    window.app = app;\r\n}(window));\r\n/**\r\n * Created by Crow on 2014/9/25.\r\n *\r\n * QC._cache 缓存区\r\n *\r\n * QC.cache 有三个方法\r\n * addParams : 向缓存区增加参数\r\n * getParams : 从缓存区获得参数\r\n * removeParams : 从缓存区删除参数\r\n */\r\n/*global jQuery, app, _*/\r\n(function (app) {\r\n    'use strict';\r\n    app = app || {};\r\n\r\n\r\n    /*变量缓存区*/\r\n    var _cache = {};\r\n\r\n    app._cache = _cache;\r\n    app.cache = {\r\n        addParams: function (type, params) {\r\n            if (arguments.length === 1) {\r\n                params = arguments[0];\r\n                type = 'request';\r\n            }\r\n            var i = 0;\r\n            _cache[type] = !_cache[type] ? {} : _cache[type];\r\n            for (i in params) {\r\n                if (params.hasOwnProperty(i)) {\r\n                    _cache[type][i] = params[i];\r\n                }\r\n            }\r\n        },\r\n        getParams: function (type, key) {\r\n            if (arguments.length === 1) {\r\n                key = arguments[0];\r\n                type = 'request';\r\n            }\r\n            var result = null;\r\n            if (_.isUndefined(key)) {\r\n                result = _cache[type];\r\n            } else {\r\n                result = _.isUndefined(_cache[type]) ? undefined : _.isUndefined(_cache[type][key]) ? undefined : _cache[type][key];\r\n            }\r\n            return result;\r\n        },\r\n        removeParams: function (type, params) {\r\n            if (arguments.length === 1) {\r\n                params = arguments[0];\r\n                type = 'request';\r\n            }\r\n            var i = 0;\r\n            if (_.isUndefined(_cache[type])) {\r\n                return 0;\r\n            }\r\n            if (params === 'all') {\r\n                for (i in _cache[type]) {\r\n                    if (_cache[type].hasOwnProperty(i)) {\r\n                        delete _cache[type][i];\r\n                    }\r\n                }\r\n            } else {\r\n                if (!_.isArray(params)) {\r\n                    params = [params];\r\n                }\r\n                for (i in params) {\r\n                    if (params.hasOwnProperty(i)) {\r\n                        delete _cache[type][params[i]];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n}(app));\r\n/**\r\n * @fileOverview\r\n * @author Crow\r\n * @version 0.0.1\r\n * @time 2015/11/20\r\n */\r\n/*global quiCloud*/\r\n(function (app) {\r\n\r\n    var _config = {\r\n\r\n    };\r\n\r\n\r\n    app.config = function(o) {\r\n\r\n    }\r\n\r\n}(app));\r\n/**\r\n * Created by Crow on 2014/9/25.\r\n * Updated by Crow on 2015-1-22 10:20:33.\r\n * 加入 ajax 请求数组，解决 hashChange 时，停止之前相同的 ajax请求，\r\n * Updated by Crow on 2015-1-22 14:40:20.\r\n * Updated by Crow on 2015年10月13日19:59:15\r\n * 代码重构\r\n */\r\n\r\n/*global jQuery, app, window, monitor, _, console*/\r\n(function ($, app) {\r\n    'use strict';\r\n    app = app || {};\r\n    /**\r\n     * params : {type, api, data, beforeSend, success, error, complete}\r\n     * params : {\r\n     *      type : get/post,\r\n     *      api : name,\r\n     *      data : ['param1', 'param2', 'param3'...],\r\n     *      isRepeat: false,    // 是否重复请求\r\n     *      beforeSend : function(){},\r\n     *      success : function(){},\r\n     *      error : function(){},\r\n     *      complete : function(){}\r\n     * }\r\n     *\r\n     * */\r\n\r\n    /**\r\n     * Updated by Crow on 2015-1-22 10:20:33.\r\n     * 使用 ajQueue 在 beforeSend 记录当前请求信息，在 complete 删除对应的请求信息，\r\n     * 当在相同的请求多次发送时，abort 前一个请求，解决页面重复请求或者 hash 值改变出现之前请求返回问题。\r\n     * */\r\n\r\n    /**\r\n     * Updated by Crow on 2015-1-22 14:42:07.\r\n     * 加入过滤添加，exceptUrl 数据包含不需要处理重复提交 ajax 类型，去掉过滤\r\n     * */\r\n    var ajQueue = [];\r\n    //var exceptUrl = [];\r\n\r\n\r\n    /**\r\n     * @desc 获得简单的JSON字符串\r\n     * @param data\r\n     * @private\r\n     */\r\n    function _getJSONSingle(data) {\r\n        var _data = data || '';\r\n        return JSON.stringify(_data);\r\n    }\r\n\r\n\r\n    /**\r\n     * @desc 获得面向后端LIST风格的JSON字符串, 其中含有一个参数值为数组\r\n     * @param data\r\n     * @private\r\n     */\r\n    function _getJSONList(data) {\r\n        var item, arr, n;\r\n        var result = [];\r\n        for (item in data) {\r\n            if (data.hasOwnProperty(item)) {\r\n                if (_.isArray(data[item])) {\r\n                    arr = data[item];\r\n                    for (n = 0; n < arr.length; n++) {\r\n                        data[item] = arr[n];\r\n                        result.push(_.clone(data));\r\n                    }\r\n\r\n                    if (arr.length === 0) {\r\n                        data[item] = '';\r\n                        result.push(_.clone(data));\r\n                    }\r\n                    delete data[item];\r\n                }\r\n            }\r\n        }\r\n        return JSON.stringify(result);\r\n    }\r\n\r\n    /**\r\n     * @desc 获得面向后端LIST风格的JSON字符串, 其中含有一个以及以上参数值为数组\r\n     * @param data\r\n     * @private\r\n     */\r\n    function _getJSONLists(data) {\r\n        var item, str, lastItem, n;\r\n        var temp = {};\r\n        var result = [];\r\n        //先将对象中的多个数据存入 temp 对象中\r\n        for (item in data) {\r\n            if (data.hasOwnProperty(item)) {\r\n                if (_.isArray(data[item])) {\r\n                    temp[item] = data[item];\r\n                    lastItem = item;\r\n                }\r\n            }\r\n        }\r\n\r\n        //遍历temp任意一个数据，这里遍历最后一个数据元素，在遍历对象中的元素，组合成 data 单数据元素，最后 push 到 adgroupIdArr 数组里面\r\n        for (n = 0; n < temp[lastItem].length; n++) {\r\n            for (str in temp) {\r\n                if (temp.hasOwnProperty(str)) {\r\n                    data[str] = temp[str][n];\r\n                    if (temp[lastItem].length === 0) {\r\n                        data[str] = '';\r\n                    }\r\n                }\r\n\r\n            }\r\n            result.push(_.clone(data));\r\n\r\n        }\r\n        return JSON.stringify(result);\r\n    }\r\n\r\n    /**\r\n     * @desc 躲避浏览器广告插件\r\n     * @param str\r\n     * @return {string}\r\n     * @private\r\n     */\r\n    function _filterAd(str) {\r\n        var result = str || '';\r\n        return result.replace(/adgroup/g, 'ddgroup');\r\n    }\r\n\r\n\r\n    /**\r\n     * TODO 统一把arr改成list\r\n     * @desc 根据数据和类型，返回可传输数据和协议\r\n     * @param data\r\n     * @param type\r\n     * @return {{}}\r\n     * @private\r\n     */\r\n    function _getDataType(data, type) {\r\n        var _type;\r\n        var _data = data || {};\r\n        var result = {};\r\n        if (_.size(_data) > 0) {\r\n            switch (type) {\r\n            case 'post':\r\n                _type = 'post';\r\n                _data = _getJSONSingle(_data);\r\n                break;\r\n            case 'delete':\r\n                _type = 'delete';\r\n                _data = _getJSONSingle(_data);\r\n                break;\r\n            case 'put':\r\n                _type = 'put';\r\n                _data = _getJSONSingle(_data);\r\n                break;\r\n            case 'post-arr':\r\n                _type = 'post';\r\n                _data = _getJSONList(_data);\r\n                break;\r\n            case 'delete-arr':\r\n                _type = 'delete';\r\n                _data = _getJSONList(_data);\r\n                break;\r\n            case 'put-arr':\r\n                _type = 'put';\r\n                _data = _getJSONList(_data);\r\n                break;\r\n            case 'post-arrs':\r\n                _type = 'post';\r\n                _data = _getJSONLists(_data);\r\n                break;\r\n            case 'delete-arrs':\r\n                _type = 'delete';\r\n                _data = _getJSONLists(_data);\r\n                break;\r\n            case 'put-arrs':\r\n                _type = 'put';\r\n                _data = _getJSONLists(_data);\r\n                break;\r\n            }\r\n        }\r\n\r\n        result.type = _type;\r\n        result.data = _data;\r\n        return result;\r\n    }\r\n\r\n\r\n    /**\r\n     * @desc 处理参数，由于接口是采用rest风格，所以这里有一部分处理api中参数\r\n     *      支持data从缓存中取或者直接赋值\r\n     * @param url {String}\r\n     * @param arr {Array}\r\n     * @param type {String}\r\n     * @return {{url: *, data: {}, type: String}}\r\n     * @private\r\n     */\r\n    function _getUrlDataType(url, data, type) {\r\n        var i, temp, value, element, dataType;\r\n        var len;\r\n        var _data = {};\r\n        var _url = url;\r\n\r\n        if (_.isArray(data)) {\r\n            len = data.length;\r\n            // 判断是否有参数\r\n            if (len > 0) {\r\n                for (i = 0; i < len; i++) {\r\n                    element = data[i];\r\n                    value = app.cache.getParams('request', element);\r\n\r\n                    // 判断参数是否有值\r\n                    if (value !== 'undefined') {\r\n\r\n                        // TODO 这个方法可以提出\r\n                        // 处理url中的参数，否则放到json中\r\n                        if (_url.indexOf('{' + element + '}') >= 0) {\r\n                            _url = _url.replace('{' + element + '}', value);\r\n                        } else {\r\n                            /*\r\n                             * Updated by Crow on 2015年4月7日15:22:56\r\n                             * 躲避浏览器广告拦截插件\r\n                             * */\r\n                            if (element.indexOf('adgroup') >= 0 && type === 'get') {\r\n                                temp = _filterAd(data[i]);\r\n                                _data[temp] = value;\r\n                            } else {\r\n                                _data[element] = value;\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } else if (_.isObject(data)) {\r\n            for (i in data) {\r\n                if (data.hasOwnProperty(i)) {\r\n                    element = data[i];\r\n                    if (_url.indexOf('{' + i + '}') >= 0) {\r\n                        _url = _url.replace('{' + i + '}', element);\r\n                    } else {\r\n                        /*\r\n                         * Updated by Crow on 2015年4月7日15:22:56\r\n                         * 躲避浏览器广告拦截插件\r\n                         * */\r\n                        if (i.indexOf('adgroup') >= 0 && type === 'get') {\r\n                            temp = _filterAd(i);\r\n                            _data[temp] = data[i];\r\n                        } else {\r\n                            _data[i] = data[i];\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        dataType = _getDataType(_data, type);\r\n\r\n        _data = dataType.data || '';\r\n        type = dataType.type || type || 'get';\r\n\r\n        // 目前只屏蔽get请求的广告拦截\r\n        _url = _filterAd(_url);\r\n\r\n        return {api: _url, data: _data, type: type};\r\n    }\r\n\r\n\r\n    /**\r\n     * 删除对应的请求\r\n     * @param cb\r\n     * @private\r\n     */\r\n    function _delQueue(params) {\r\n        // 相同请求，abort() 之前请求并删除队列对应存储\r\n        ajQueue.forEach(function (elem, index) {\r\n            // update by dyy 增加 data 判断，有时候需要两个相同的 ajax 请求，但是 data 参数值不一样\r\n            if (elem && elem.api === params.api && _.isEqual(elem.data, params.data) && elem.type === params.type) {\r\n                ajQueue.splice(index, 1);\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 判断队列中是否有相同的请求，并返回位置\r\n     * @param params\r\n     * @returns {number}\r\n     * @private\r\n     */\r\n    function _whereQueue(params) {\r\n        var result = -1;\r\n        // 相同请求，abort() 之前请求并删除队列对应存储\r\n        ajQueue.forEach(function (elem, index) {\r\n            // update by dyy 增加 data 判断，有时候需要两个相同的 ajax 请求，但是 data 参数值不一样\r\n            if (elem && elem.api === params.api && _.isEqual(elem.data, params.data) && elem.type === params.type) {\r\n                result = index;\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 加入队列中\r\n     * @param params\r\n     * @param cb\r\n     * @private\r\n     */\r\n    function _addQueue(jqXHR, params, success) {\r\n        var obj = {\r\n            'xhr': jqXHR,\r\n            'data': params.data,\r\n            'api': params.api,\r\n            'type': params.type,\r\n            'cb': []\r\n        };\r\n        if (success) {\r\n            obj.cb = [success];\r\n        }\r\n        ajQueue.push(obj);\r\n    }\r\n\r\n    /**\r\n     * 加入回调队列\r\n     * @param index\r\n     * @param cb\r\n     * @private\r\n     */\r\n    function _addQueueCb(index, cb) {\r\n        ajQueue[index].cb.push(cb);\r\n    }\r\n\r\n    /**\r\n     * @desc 调用后端统一接口\r\n     * @param params\r\n     */\r\n    app.connect.ajax = function (params) {\r\n        var cache = true;\r\n        // udt: url data type\r\n        var udt = _getUrlDataType(params.api, params.data, params.type);\r\n\r\n        if (udt.type === 'get') {\r\n            cache = false;\r\n        }\r\n\r\n        $.ajax({\r\n            type: udt.type,                         //String，默认：get, HTTP请求方法\r\n            url: udt.api,                           //String，发送请求地址\r\n            context: params.context,\r\n            data: udt.data,                         //Object/String,发送到服务器的数据\r\n            dataType: 'json',                       //String，预期服务器返回的数据类型\r\n            async: params.async || true,            //Boolean, 默认，true，是否异步\r\n            headers: {\r\n                'X-HTTP-Method-Override': udt.type,\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n            },\r\n            cache: cache,                           //Boolean，默认：true,是否从浏览器缓存中加载请求信息\r\n            beforeSend: function (jqXHR) {\r\n\r\n                // 检查队列中是否有这个请求\r\n                var num = _whereQueue(udt);\r\n                if (num != -1) {\r\n                    _addQueueCb(num, params.success);\r\n                    \r\n                    jqXHR.abort();\r\n                } else {\r\n                    _addQueue(jqXHR, udt, params.success);\r\n                }\r\n\r\n                if (params.beforeSend) {\r\n                    params.beforeSend();\r\n                }\r\n            },//Function，参数：XMLHttpRequest 发送请求前执行\r\n            success: function (json) {\r\n                //var sThis = this;\r\n                // session超时跳转\r\n                if (json.sessionTimeout) {\r\n                    window.location.href = \"/www/home/index.html\";\r\n                    return;\r\n                }\r\n                var num = _whereQueue(udt);\r\n                ajQueue[num].cb.forEach(function (elem) {\r\n                    if (elem) {\r\n                        elem(json);\r\n                    }\r\n                });\r\n            },//Function，参数：data,textStatus  请求成功后回调函数\r\n            error: function (error, setts) {\r\n                if (params.error) {\r\n                    params.error(error, setts);\r\n                }\r\n            },//Function，参数:XMLHttpRequest, textStatus, errorThrown\r\n            complete: function (jqXHR) {\r\n                // 完成删除队列请求\r\n                _delQueue(udt);\r\n                if (params.complete) {\r\n                    params.complete(jqXHR);\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    app.connect.socket = {\r\n\r\n    };\r\n\r\n}(jQuery, app));\r\n\r\n/**\r\n * Created by Crow on 2014/9/26.\r\n * app.control 组件控制模块\r\n */\r\n\r\n/*global jQuery, app, _*/\r\n(function (app) {\r\n    'use strict';\r\n    //初始化control\r\n    app = app || {};\r\n\r\n    var _cache = null;\r\n\r\n    function addCache(arr) {\r\n        var n;\r\n        _cache = _cache || {};\r\n        for (n = 0; n < arr.length; n++) {\r\n            _cache[arr[n]] = _cache[arr[n]] || {};\r\n            _cache[arr[n]].status = 1;\r\n        }\r\n    }\r\n\r\n    function reduceCache(arr) {\r\n        var n;\r\n        _cache = _cache || {};\r\n        for (n = 0; n < arr.length; n++) {\r\n            delete _cache[arr[n]];\r\n        }\r\n    }\r\n\r\n    function getRender(arr) {\r\n        var n;\r\n        var result = [];\r\n        if (!_cache) {\r\n            return arr;\r\n        }\r\n\r\n        _cache = _cache || {};\r\n        for (n = 0; n < arr.length; n++) {\r\n            if (_cache[arr[n]] === undefined) {\r\n                result.push(arr[n]);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function getDestroy(arr) {\r\n        var i;\r\n        var result = [];\r\n        if (!_cache) {\r\n            return result;\r\n        }\r\n\r\n        _cache = _cache || {};\r\n        for (i in _cache) {\r\n            if (_cache.hasOwnProperty(i)) {\r\n                if (_.indexOf(arr, i) < 0) {\r\n                    result.push(i);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function getHas(arr) {\r\n        var n;\r\n        var result = [];\r\n        if (!_cache) {\r\n            return result;\r\n        }\r\n\r\n        _cache = _cache || {};\r\n        for (n = 0; n < arr.length; n++) {\r\n            if (_cache[arr[n]]) {\r\n                result.push(arr[n]);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    app.control = {\r\n        updateModules: function (route, hashSearch, diffPath) {\r\n            var arr = route.modules;\r\n            var cb = route.handler;\r\n            var _render = getRender(arr);\r\n            var _destroy = getDestroy(arr);\r\n            var _has = getHas(arr);\r\n            var _temp = app.url.getHashSearchObj();\r\n\r\n            // 如果路径没有改变，则不删除全部的参数\r\n            if (diffPath) {\r\n                app.cache.removeParams('all');\r\n                cb();\r\n            }\r\n\r\n            app.cache.addParams(_temp);\r\n\r\n            //销毁\r\n            if (_destroy.length) {\r\n                _destroy.forEach(function (elem) {\r\n                    if (_cache[elem].status) {\r\n                        _cache[elem].fn.destroy();\r\n                        //delete _cache[elem];\r\n                    }\r\n                });\r\n            }\r\n\r\n            //初次渲染模块\r\n            app.load.use(_render, function () {\r\n                var i;\r\n                for (i in arguments) {\r\n                    if (arguments.hasOwnProperty(i)) {\r\n                        _cache[_render[i]] = _cache[_render[i]] || {};\r\n                        if (!_cache[_render[i]].fn) {\r\n                            _cache[_render[i]].fn = new arguments[i];\r\n                        }\r\n                        _cache[_render[i]].fn.render();\r\n                    }\r\n                }\r\n            });\r\n\r\n            //更新\r\n            if (_has.length) {\r\n                app.load.use(_has, function () {\r\n                    var i, j, str, isUpdate;\r\n                    var _dependence = [];\r\n                    for (i in arguments) {\r\n                        if (arguments.hasOwnProperty(i)) {\r\n                            isUpdate = false;\r\n                            if (_.isArray(_cache[_has[i]].fn.dependence)) {\r\n                                for (j = 0; j < _cache[_has[i]].fn.dependence.length; j++) {\r\n\r\n                                    str = _cache[_has[i]].fn.dependence[j];\r\n\r\n                                    // 是否有依赖参数、是否有搜索参数、是否等于上一次、这个参数是否在依赖参数里面\r\n                                    if (_cache[_has[i]].fn.dependence && (!hashSearch || hashSearch[str] !== _temp[str]) && _.indexOf(_cache[_has[i]].fn.dependence, str) > -1) {\r\n                                        isUpdate = true;\r\n                                        _dependence.push(str);\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            if (_cache[_has[i]].fn.dependence === 'hash') {\r\n                                isUpdate = true;\r\n                            }\r\n\r\n                            if (isUpdate) {\r\n                                _cache[_has[i]].fn.update(_dependence);           // 更新模块\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            // 这边先执行\r\n            addCache(_render);\r\n            reduceCache(_destroy);\r\n        },\r\n        load: function (route, hashSearch, diffPath) {\r\n            if (route) {\r\n                this.updateModules(route, hashSearch, diffPath);\r\n            }\r\n        }\r\n    };\r\n\r\n}(app));\r\n/*global window, _*/\r\n(function (app, win) {\r\n    'use strict';\r\n    app = app || {};\r\n\r\n    var modMap = {};\r\n    var moduleMap = {};\r\n\r\n    var slice = [].slice;\r\n\r\n    var doc = document;\r\n    var head = doc.head || doc.getElementsByTagName(\"head\")[0] || doc.documentElement;\r\n    var docCharset = doc.charset;\r\n    var docUrl = location.href.split('?')[0];//去除问号之后部分\r\n    var baseUrl = docUrl;\r\n\r\n    var gid = 0;\r\n    var commentRegExp = /(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/mg;\r\n    var cjsRequireRegExp = /[^.]\\s*require\\s*\\(\\s*[\"']([^'\"\\s]+)[\"']\\s*\\)/g;\r\n    var interactiveScript = null;\r\n    var currentlyAddingScript = null;\r\n    var curExecModName = null;\r\n\r\n    var idPrefix = 'load-js-';\r\n\r\n    var o = {};\r\n\r\n    function _getGid() {\r\n        return gid++;\r\n    }\r\n\r\n\r\n    /**\r\n     * 处理类似IE11问题\r\n     * http://www.cnblogs.com/diligenceday/p/4504160.html\r\n     * @returns {*}\r\n     */\r\n    function getCurrentNode() {\r\n        if (document.currentScript) {\r\n            return document.currentScript\r\n        }\r\n        var arrScript = document.getElementsByTagName(\"script\");\r\n        var len = arrScript.length;\r\n        for(var i= 0; i<len; i++) {\r\n            if(arrScript[i].readyState === \"interactive\") {\r\n                return arrScript[i];\r\n            }\r\n        }\r\n\r\n        //IE11的特殊处理;\r\n        var path = getCurrentPath();\r\n        for(var i= 0; i<len; i++) {\r\n            if(path.indexOf(arrScript[i].src)!==-1) {\r\n                return arrScript[i];\r\n            }\r\n        }\r\n        throw new Error(\"getCurrentNode error\");\r\n    }\r\n\r\n    function getCurrentPath() {\r\n        var repStr = function(str) {\r\n            return (str || \"\").replace(/[\\&\\?]{1}[\\w\\W]+/g,\"\") || \"\";\r\n        };\r\n        if (doc.currentScript) {\r\n            return repStr(doc.currentScript.src);\r\n        }\r\n\r\n        //IE11没有了readyState属性， 也没有currentScript属性;\r\n        // 参考 https://github.com/samyk/jiagra/blob/master/jiagra.js\r\n        var stack;\r\n        try {\r\n            a.b.c() //强制报错,以便捕获e.stack\r\n        } catch (e) { //safari的错误对象只有line,sourceId,sourceURL\r\n            stack = e.stack\r\n            if (!stack && window.opera) {\r\n                //opera 9没有e.stack,但有e.Backtrace,但不能直接取得,需要对e对象转字符串进行抽取\r\n                stack = (String(e).match(/of linked script \\S+/g) || []).join(\" \")\r\n            }\r\n        }\r\n        if (stack) {\r\n            /**e.stack最后一行在所有支持的浏览器大致如下:\r\n             *chrome23:\r\n             *firefox17:\r\n             *opera12:http://www.oldapps.com/opera.php?system=Windows_XP\r\n             *IE10:\r\n             * //firefox4+ 可以用document.currentScript\r\n             */\r\n            stack = stack.split(/[@ ]/g).pop(); //取得最后一行,最后一个空格或@之后的部分\r\n            stack = stack[0] === \"(\" ? stack.slice(1, -1) : stack.replace(/\\s/, \"\"); //去掉换行符\r\n            return stack.replace(/(:\\d+)?:\\d+$/i, \"\"); //去掉行号与或许存在的出错字符起始位置\r\n        }\r\n        //实在不行了就走这里;\r\n        var node = getCurrentNode();\r\n        //IE>=8的直接通过src可以获取，IE67要通过getAttriubte获取src;\r\n        return repStr(document.querySelector ? node.src : node.getAttribute(\"src\", 4)) || \"\";\r\n\r\n        throw new Error(\"getCurrentPath error!\");\r\n    }\r\n\r\n    function _loadJs(src, success, error, option) {\r\n        var d = _.extend({\r\n            charset: docCharset\r\n        }, option);\r\n        var node = doc.createElement('script');\r\n        node.src = src + '?' + app.version;\r\n        node.id = idPrefix + _getGid();\r\n        node.charset = d.charset;\r\n        if ('onload' in node) {\r\n            node.onload = success;\r\n            node.onerror = error;\r\n        } else {\r\n            node.onreadystatechange = function () {\r\n                if (/loaded|complete/.test(node.readyState)) {\r\n                    success();\r\n                }\r\n            };\r\n        }\r\n        //currentlyAddingScript = node;\r\n        head.appendChild(node);\r\n    }\r\n\r\n    function getCurSrc() {\r\n        if (doc.currentScript) {\r\n            return doc.currentScript.src;\r\n        }\r\n        if (currentlyAddingScript) {\r\n            return currentlyAddingScript.src;\r\n        }\r\n        // For IE6-9 browsers, the script onload event may not fire right\r\n        // after the script is evaluated. Kris Zyp found that it\r\n        // could query the script nodes and the one that is in \"interactive\"\r\n        // mode indicates the current script\r\n        // ref: http://goo.gl/JHfFW\r\n        if (interactiveScript && interactiveScript.readyState === \"interactive\") {\r\n            return interactiveScript.src;\r\n        }\r\n\r\n        var scripts = head.getElementsByTagName(\"script\");\r\n        for (var i = scripts.length - 1; i >= 0; i--) {\r\n            var script = scripts[i];\r\n            if (script.readyState === \"interactive\") {\r\n                interactiveScript = script;\r\n                return interactiveScript.src;\r\n            }\r\n        }\r\n\r\n        return getCurrentPath();\r\n    }\r\n\r\n    function isUrl(url) {\r\n        return url.search(/^(http:\\/\\/|https:\\/\\/|\\/\\/)/) !== -1;\r\n    }\r\n\r\n    function fixUrl(url) {\r\n        return url.replace(/([^:])\\/+/g, '$1/');\r\n    }\r\n\r\n    function getUrl(path, url) {\r\n        //绝对网址\r\n        if (isUrl(path)) {\r\n            return fixUrl(path);\r\n        }\r\n\r\n        var rootUrl;\r\n        //修复url\r\n        if (rootUrl = url.match(/[^\\/]*\\/\\/[^\\/]*\\//)) {\r\n            //http://yanhaijing.com/abc\r\n            url = url.slice(0, url.lastIndexOf('/') + 1);\r\n            rootUrl = rootUrl[0];\r\n        } else {\r\n            //http://yanhaijing.com\r\n            rootUrl = url = url + '/';\r\n        }\r\n\r\n        // /开头\r\n        if (path.search(/^\\//) !== -1) {\r\n            return fixUrl(rootUrl + path);\r\n        }\r\n\r\n        // ../开头\r\n        if (path.search(/^\\.\\.\\//) !== -1) {\r\n            while (path.search(/^\\.\\.\\//) !== -1) {\r\n                if (url.lastIndexOf('/', url.length - 2) !== -1) {\r\n                    path = path.slice(3);\r\n                    url = url.slice(0, url.lastIndexOf('/', url.length - 2) + 1);\r\n                } else {\r\n                    throw new Error('url错误');\r\n                }\r\n            }\r\n\r\n            return fixUrl(url + path);\r\n        }\r\n        // ./\r\n        path = path.search(/^\\.\\//) !== -1 ? path.slice(2) : path;\r\n\r\n        return fixUrl(url + path);\r\n    }\r\n\r\n    function fixSuffix(url, suffix) {\r\n        var reg = new RegExp('\\\\.' + suffix + '$', 'i');\r\n        return url.search(reg) !== -1 ? url : url + '.' + suffix;\r\n    }\r\n\r\n    function  replacePath(id) {\r\n        var ids = id.split('/');\r\n        // id中不包含路径 并 查找路径失败\r\n        if (ids.length < 2 && !(ids[0] in o.path)) {\r\n            return id;\r\n        }\r\n        ids[0] = o.path[ids[0]];\r\n        return ids.join('/');\r\n    }\r\n\r\n    function getDepUrl(id, url) {\r\n        var pathId = replacePath(id);\r\n        //找到path 基于baseUrl\r\n        if (pathId !== id) {\r\n            url = o.baseUrl;\r\n        }\r\n        return fixSuffix(getUrl(pathId, url || o.baseUrl), 'js');\r\n    }\r\n\r\n    function getIdUrl(id) {\r\n        //没有id的情况\r\n        if (!id) {\r\n            return getCurSrc();\r\n        }\r\n        //id不能为相对路径,amd规定此处也不能带后缀，此处放宽限制。\r\n        if (id.search(/^\\./) !== -1) {\r\n            throw new Error('资源路径：' + id + '必须是绝对定位');\r\n        }\r\n        return fixSuffix(getUrl(id, o.baseUrl), 'js');\r\n    }\r\n\r\n    function require(id, url) {\r\n        var url = getDepUrl(id, url || curExecModName);\r\n        return moduleMap[url] && moduleMap[url].exports;\r\n    }\r\n\r\n    function fixPath(path) {\r\n        //path是网址\r\n        if (isUrl(path)) {\r\n            return getUrl('./', path).slice(0, -1);\r\n        }\r\n        return path;\r\n    }\r\n\r\n    function config(option) {\r\n        if (!_.isObject(option)) {\r\n            return _.extend({}, o);\r\n        }\r\n\r\n        //处理baseUrl\r\n        if (option.baseUrl) {\r\n            option.baseUrl = getUrl(option.baseUrl, docUrl);\r\n        }\r\n\r\n        //处理path\r\n        if (_.isObject(option.path)) {\r\n            for (var key in option.path) {\r\n                option.path[key] = fixPath(option.path[key]);\r\n            }\r\n        }\r\n        o = _.extend(o, option);\r\n\r\n        //fix keywords\r\n        o.path.BASEURL = fixPath(option.baseUrl || o.baseUrl);\r\n        o.path.DOCURL = fixPath(docUrl);\r\n        return _.extend({}, o);\r\n    }\r\n\r\n    function execMod(modName, callback, params) {\r\n        //判断定义的是函数还是非函数\r\n        if (!params) {\r\n            moduleMap[modName].exports = modMap[modName].callback;\r\n        } else {\r\n            curExecModName = modName;\r\n            //commonjs\r\n            var exp = modMap[modName].callback.apply(null, params);\r\n            curExecModName = null;\r\n            //amd和返回值的commonjs\r\n            if (exp) {\r\n                moduleMap[modName].exports = exp;\r\n            }\r\n        }\r\n        //执行回调函数\r\n        callback(moduleMap[modName].exports);\r\n\r\n        //执行complete队列\r\n        execComplete(modName);\r\n    }\r\n\r\n    function execComplete(modName) {\r\n        //模块定义完毕 执行load函数,当加载失败时，会不存在module\r\n        for (var i = 0; i < modMap[modName].oncomplete.length; i++) {\r\n            modMap[modName].oncomplete[i](moduleMap[modName] && moduleMap[modName].exports);\r\n        }\r\n        //释放内存\r\n        modMap[modName].oncomplete = [];\r\n    }\r\n\r\n    function loadMod(id, callback, option) {\r\n        //commonjs\r\n        if (id === 'require') {\r\n            callback(require);\r\n            return -1;\r\n        }\r\n        if (id === 'exports') {\r\n            var exports = moduleMap[option.baseUrl].exports = null;\r\n            callback(exports);\r\n            return -2;\r\n        }\r\n        if (id === 'module') {\r\n            callback(moduleMap[option.baseUrl]);\r\n            return -3;\r\n        }\r\n        var modName = getDepUrl(id, option.baseUrl);\r\n        //未加载\r\n        if (!modMap[modName]) {\r\n            modMap[modName] = {\r\n                status: 'loading',\r\n                oncomplete: []\r\n            };\r\n            //\r\n            _loadJs(modName, function () {\r\n                if (!_.isFunction(modMap[modName].callback)) {\r\n                    execMod(modName, callback);\r\n                    return 0;\r\n                }\r\n                //\r\n                //define的是函数\r\n                use(modMap[modName].deps, function () {\r\n                    execMod(modName, callback, slice.call(arguments, 0));\r\n                }, {baseUrl: modName});\r\n                return 1;\r\n            }, function () {\r\n                modMap[modName].status = 'error';\r\n                callback();\r\n                execComplete(modName);//加载失败执行队列\r\n            });\r\n            return 0;\r\n        }\r\n\r\n        //加载失败\r\n        if (modMap[modName].status === 'error') {\r\n            callback();\r\n            return 1;\r\n        }\r\n        //正在加载\r\n        if (modMap[modName].status === 'loading') {\r\n            modMap[modName].oncomplete.push(callback);\r\n            return 1;\r\n        }\r\n\r\n        //加载完成\r\n        //尚未执行完成\r\n        if (!moduleMap[modName].exports) {\r\n            //如果define的不是函数\r\n            if (!_.isFunction(modMap[modName].callback)) {\r\n                execMod(modName, callback);\r\n                return 2;\r\n            }\r\n\r\n            //define的是函数\r\n            use(modMap[modName].deps, function () {\r\n                execMod(modName, callback, slice.call(arguments, 0));\r\n            }, {baseUrl: modName});\r\n            return 3;\r\n        }\r\n\r\n        //已经执行过\r\n        callback(moduleMap[modName].exports);\r\n        return 4;\r\n    }\r\n\r\n    function use(deps, callback, option) {\r\n        if (arguments.length < 2) {\r\n            throw new Error('load.use arguments miss');\r\n            return 0;\r\n        }\r\n\r\n        if (typeof deps === 'string') {\r\n            deps = [deps];\r\n        }\r\n\r\n        if (!_.isArray(deps) || !_.isFunction(callback)) {\r\n            throw new Error('load.use arguments type error');\r\n            return 1;\r\n        }\r\n        //默认为当前脚本的路径或baseurl\r\n        if (!_.isObject(option)) {\r\n            option = {};\r\n        }\r\n        option.baseUrl = option.baseUrl || o.baseUrl;\r\n\r\n        if (deps.length === 0) {\r\n            callback();\r\n            return 2;\r\n        }\r\n        var depsCount = deps.length;\r\n        var params = [];\r\n        for (var i = 0; i < deps.length; i++) {\r\n            (function (j) {\r\n                loadMod(deps[j], function (param) {\r\n                    depsCount--;\r\n                    params[j] = param;\r\n                    if (depsCount === 0) {\r\n                        callback.apply(null, params);\r\n                    }\r\n                }, option);\r\n            }(i));\r\n        }\r\n\r\n        return 3;\r\n    }\r\n\r\n    function define(name, deps, callback) {\r\n        //省略模块名\r\n        if (typeof name !== 'string') {\r\n            callback = deps;\r\n            deps = name;\r\n            name = null;\r\n        }\r\n\r\n        //无依赖\r\n        if (!_.isArray(deps)) {\r\n            callback = deps;\r\n            deps = [];\r\n        }\r\n\r\n        //支持commonjs\r\n        if (deps.length === 0 && _.isFunction(callback)) {\r\n            callback\r\n                .toString()\r\n                .replace(commentRegExp, '')\r\n                .replace(cjsRequireRegExp, function (match, dep) {\r\n                    deps.push(dep);\r\n                });\r\n            var arr = ['require'];\r\n            if (callback.length > 1) {\r\n                arr.push('exports');\r\n            }\r\n            if (callback.length > 2) {\r\n                arr.push('module');\r\n            }\r\n            deps = arr.concat(deps);\r\n        }\r\n\r\n        var modName = getIdUrl(name).split('?')[0];//fix 后缀\r\n        modMap[modName] = modMap[modName] || {};\r\n        modMap[modName].deps = deps;\r\n        modMap[modName].callback = callback;\r\n        modMap[modName].status = 'loaded';\r\n        modMap[modName].oncomplete = modMap[modName].oncomplete || [];\r\n        moduleMap[modName] = {};\r\n\r\n        return 0;\r\n    }\r\n\r\n    function debug() {\r\n        \r\n    }\r\n\r\n    function getData() {\r\n        return o;\r\n    }\r\n\r\n    var load = {\r\n        use: use,\r\n        _loadJs: _loadJs,\r\n        config: config,\r\n        define: define,\r\n        require: require,\r\n        debug: debug,\r\n        getData: getData\r\n    };\r\n\r\n    load.config({\r\n        baseUrl: baseUrl,\r\n        path: {}\r\n    });\r\n    win.define = define;\r\n    app.load = load;\r\n}(app, window));\r\n\r\n/**\r\n * Created by Crow on 2014/9/25.\r\n */\r\n/*global quiCloud*/\r\n(function (app) {\r\n    'use strict';\r\n    app = app || {};\r\n    app.modules = {};\r\n}(app));\r\n/**\r\n * @fileOverview\r\n * @author Crow\r\n * @version 0.0.1\r\n * @time 2015/11/11\r\n */\r\n\r\n\r\n/*global app, _, console*/\r\n(function (app) {\r\n    'use strict';\r\n\r\n    /**\r\n     * @desc 盒子\r\n     * @type {Object}\r\n     */\r\n    var PB = {};\r\n\r\n    /**\r\n     * @desc 存储 不公开\r\n     * @type {Object}\r\n     */\r\n    var _storage = {};\r\n\r\n    /**\r\n     * @desc 订阅者（观察者）\r\n     * @param  {String|Array}   types     订阅类型\r\n     * @param  {Function|Array} functions 订阅者\r\n     * @return {void}\r\n     */\r\n    PB.subscribe = function (types, functions) {\r\n        if (_.isString(types)) {\r\n            types = [types];\r\n        }\r\n        if (_.isFunction(functions)) {\r\n            functions = [functions];\r\n        }\r\n\r\n        types.forEach(function (name) {\r\n            if (!_storage[name]) {\r\n                _storage[name] = [];\r\n            }\r\n            functions.forEach(function (fn) {\r\n                if (_.isFunction(fn)) {\r\n                    _storage[name].push(fn);\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @desc 取消订阅\r\n     * @param  {String|Array}   types     订阅的类型\r\n     * @param  {Function|Array} functions 订阅者\r\n     * @return {void}\r\n     */\r\n     // TODO unSubscribe 一个单词 unsubscribe\r\n    PB.unSubscribe = function (types, functions) {\r\n        var index;\r\n\r\n        if (_.isString(types)) {\r\n            types = [types];\r\n        }\r\n        if (_.isFunction(functions)) {\r\n            functions = [functions];\r\n        }\r\n\r\n        types.forEach(function (name) {\r\n            if (!_storage[name]) {\r\n                \r\n            } else {\r\n                if (functions) {\r\n                    functions.forEach(function(fn) {\r\n                        index = _storage[name].indexOf(fn);\r\n                        _storage[name].splice(index, 1);\r\n                    });\r\n                } else {\r\n                    _storage[name] = [];\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @desc 订阅(被观察者)\r\n     * @param  {String|Array} types 类型\r\n     * @param  {Object}       data  数据\r\n     * @return {void}\r\n     */\r\n    PB.publish = function (types, data) {\r\n\r\n        if (_.isString(types)) {\r\n            types = [types];\r\n        }\r\n\r\n        types.forEach(function (name) {\r\n            if (!_storage[name] || _storage[name].constructor !== Array) {\r\n                _storage[name] = [];\r\n            }\r\n\r\n            _storage[name].forEach(function (fn) {\r\n                fn(data);\r\n            });\r\n        });\r\n    };\r\n\r\n    PB.get = function () {\r\n        return _storage;\r\n    };\r\n\r\n    app.pb = PB;\r\n}(app, _));\r\n/**\r\n *\r\n * Created by Crow on 2014/9/27.\r\n *\r\n * Recently by Crow on 2014/12/22.\r\n *\r\n */\r\n\r\n/*global app, _hmt, _, window, console*/\r\n(function (app) {\r\n    'use strict';\r\n    app = app || {};\r\n\r\n    app.route = {\r\n        cb: null,\r\n        routes: {},     //缓存以保存当前已经注册的路由\r\n        mode: null,     //取值有两项： hash和history，用来判断是否使用history URL_PATH\r\n        root: '/',      //应用的根路径\r\n        config: function (options) {\r\n            this.cb = options.cb;\r\n            this.mode = options && options.mode && options.mode === 'history' && !!(window.history.pushState) ? 'history' : 'hash';\r\n            this.root = options && options.root ? '/' + this.clearSlashes(options.root) + '/' : '/';\r\n            return this;\r\n        },\r\n        clearSlashes: function (path) {\r\n            return path.toString().replace(/\\/$/, '').replace(/^\\//, '');\r\n        },\r\n        add: function (re, mols, handler) {\r\n            if (_.isArray(re)) {\r\n                mols = re;\r\n                handler = mols;\r\n            }\r\n            if (_.isFunction(re)) {\r\n                \r\n                return false;\r\n            }\r\n            if (this.routes[re]) {\r\n                \r\n                return false;\r\n            }\r\n\r\n            this.routes[re] = {\r\n                modules: mols,\r\n                handler: handler || new Function()\r\n            };\r\n            return this;\r\n        },\r\n        remove: function (key) {\r\n            if (this.routes[key]){\r\n                delete this.routes[key];\r\n            }\r\n            return this;\r\n        },\r\n        flush: function () {\r\n            this.routes = {};\r\n            this.mode = null;\r\n            this.root = '/';\r\n            return this;\r\n        },\r\n        check: function (f) {\r\n            // 处理路径是否改变，默认改变\r\n            var diffPath = true;\r\n\r\n            var _path = app.url.getHashPath();\r\n            var _search = f ? app.url.getSearchObj(f) : app.url.getHashSearchObj();\r\n\r\n            if (f) {\r\n                diffPath = _path !== app.url.getHashPath(f);\r\n\r\n                if (diffPath) {\r\n                    if (this.cb) {\r\n                        this.cb(_path);\r\n                    }\r\n                }\r\n            }\r\n\r\n            app.control.load(this.routes[_path], _search, diffPath);\r\n            return this;\r\n        },\r\n        /**\r\n         * revise by Crow on 2014/12/18\r\n         * 将计时器改为 hashchange 事件监听\r\n         * */\r\n        listen: function () {\r\n            var self = app.route;\r\n            var current = app.url.getHash();\r\n\r\n            // 绑定前先检查当前路由\r\n            self.check('original');\r\n            window.onhashchange = function () {\r\n                if (current !== app.url.getHash()) {\r\n                    self.check(current);\r\n                    current = app.url.getHash();\r\n                }\r\n            };\r\n            return self;\r\n        },\r\n        navigate: function (path) {\r\n            path = path || '';\r\n            if (this.mode === 'history') {\r\n                window.history.pushState(null, null, this.root + this.clearSlashes(path));\r\n            } else {\r\n                window.location.href.match(/#(.*)$/);\r\n                window.location.href = window.location.href.replace(/#(.*)$/, '') + '#' + path;\r\n            }\r\n            this.check();\r\n            return this;\r\n        }\r\n    };\r\n\r\n    app.listen = app.route.listen;\r\n\r\n}(app));\r\n/**\r\n * @fileOverview 公共函数，没有依赖库\r\n * @author Crow\r\n * @version 0.0.1\r\n *\r\n * url:\r\n *\r\n *      window.location.href : 整个URL\r\n *      window.location.protocol : URL 协议\r\n *      window.location.host : URL的主机部分\r\n *      window.location.port : URL端口\r\n *      window.location.pathname : URL文件路径\r\n *      window.location.hash : 锚点\r\n */\r\n/*global window, quiCloud*/\r\n(function (win, app) {\r\n    'use strict';\r\n\r\n    var obj = {\r\n        'href': '',             //整个URL\r\n        'protocol': '',         //URL 协议\r\n        'host': '',             //URL的主机部分\r\n        'hostName': '',         //URL的主机名\r\n        'port': '',             //URL端口\r\n        'pathname': '',         //URL文件路径\r\n        'hash': '',             //锚点\r\n        'search': ''\r\n    };\r\n\r\n    app.url = app.url || {};\r\n\r\n    /**\r\n     * 获得当前完整的 URL\r\n     * @extends {Url}\r\n     * @returns {string|string}\r\n     */\r\n    app.url.getHref = function() {\r\n        return decodeURI(win.location.href) || '';\r\n    };\r\n\r\n    /**\r\n     * 获得当前 URL 的协议\r\n     * @extends {Url}\r\n     * @returns {string|string}\r\n     */\r\n    app.url.getProtocol = function() {\r\n        return decodeURI(win.location.protocol) || '';\r\n    };\r\n\r\n    /**\r\n     * 获得当前 URL 的主机名和端口号\r\n     * @extends {Url}\r\n     * @returns {string|string}\r\n     */\r\n    app.url.getHost = function() {\r\n        return decodeURI(win.location.host) || '';\r\n    }\r\n\r\n    /**\r\n     * 获得当前 URL 的主机名\r\n     * @extends {Url}\r\n     * @returns {string|string}\r\n     */\r\n    app.url.getHostName = function() {\r\n        return decodeURI(win.location.hostname) || '';\r\n    }\r\n\r\n    /**\r\n     * 获得当前 URL 的端口号\r\n     * @extends {Url}\r\n     * @returns {string|string}\r\n     */\r\n    app.url.getPort = function() {\r\n        return encodeURI(win.location.port) || '';\r\n    }\r\n\r\n    /**\r\n     * 获得当前 URL 的路径\r\n     * @extends {Url}\r\n     * @returns {string|string}\r\n     */\r\n    app.url.getPathname = function() {\r\n        return decodeURI(win.location.pathname) || '';\r\n    }\r\n\r\n    /**\r\n     * 获得当前 URL hash\r\n     * @extends {Url}\r\n     * @returns {string|string}\r\n     */\r\n    app.url.getHash = function() {\r\n        return decodeURI(win.location.hash) || '';\r\n    }\r\n\r\n    /**\r\n     * 获得当前 URL 的查询字串\r\n     * @extends {Url}\r\n     * @returns {string|string}\r\n     */\r\n    app.url.getSearch = function() {\r\n        return decodeURI(win.location.search) || '';\r\n    };\r\n\r\n    /**\r\n     * 获得当前 URL 的对象\r\n     * @extends {Url}\r\n     * @returns {{}}\r\n     */\r\n    app.url.getAll = function() {\r\n        var i = '',\r\n            o = {};\r\n\r\n        o = this.obj || {};\r\n\r\n        for (i in o) {\r\n            if (o.hasOwnProperty(i)) {\r\n                o[i] = win.location[i] || '';\r\n            }\r\n        }\r\n        return o;\r\n    };\r\n\r\n    /**\r\n     * 获得当前 URL 的 hash path\r\n     * @extends {Url}\r\n     * @returns {*}\r\n     */\r\n    app.url.getHashPath = function(str) {\r\n        var _hash = str || this.getHash(),\r\n            hashPath = null;\r\n\r\n        if (_hash) {\r\n            _hash = _hash.split('?')[0];\r\n            hashPath = _hash.replace('#', '');\r\n        } else {\r\n            hashPath = '';\r\n        }\r\n\r\n        return hashPath;\r\n    };\r\n\r\n    /**\r\n     * 获得当前 URL hash search的某一个值\r\n     * @extends {Url}\r\n     * @param key\r\n     * @returns {*}\r\n     */\r\n    app.url.getHashSearchObj = function(key) {\r\n        var hash = this.getHash(),\r\n            result = {},\r\n            arr = [];\r\n\r\n        var i, temp, search;\r\n\r\n        if (/\\?/.test(hash)) {\r\n            search = hash.split('?')[1];\r\n            arr = search.split('&');\r\n\r\n            for (i = 0; i < arr.length; i++) {\r\n                temp = arr[i].split('=');\r\n                if (key) {\r\n                    if (temp[0] === key) {\r\n                        result = temp[1];\r\n                        break;\r\n                    }\r\n                } else {\r\n                    result[temp[0]] = temp[1];\r\n                }\r\n            }\r\n        } else {\r\n            result = '';\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n\r\n    app.url.getSearchObj = function (o) {\r\n        var hash = o,\r\n            result = {},\r\n            arr = [];\r\n\r\n        var i, temp, search;\r\n\r\n        if (/\\?/.test(hash)) {\r\n            search = hash.split('?')[1];\r\n            arr = search.split('&');\r\n\r\n            for (i = 0; i < arr.length; i++) {\r\n                temp = arr[i].split('=');\r\n                result[temp[0]] = temp[1];\r\n            }\r\n        } else {\r\n            result = '';\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * 设置当前 URL\r\n     * @extends {Url}\r\n     * @param str\r\n     */\r\n    app.url.setHref = function(str) {\r\n        win.location.href = encodeURI(str);\r\n    };\r\n\r\n    /**\r\n     * 设置当前 URL 协议\r\n     * @extends {Url}\r\n     * @param str\r\n     */\r\n    app.url.setProtocol = function(str) {\r\n        win.location.protocol = encodeURI(str);\r\n    };\r\n\r\n    app.url.setHost = function(str) {\r\n        win.location.host = encodeURI(str);\r\n    };\r\n\r\n    app.url.setHostName = function(str) {\r\n        win.location.hostname = encodeURI(str);\r\n    };\r\n\r\n    app.url.setPort = function(str) {\r\n        win.location.port = encodeURI(str);\r\n    };\r\n\r\n    app.url.setPathname = function(str) {\r\n        win.location.pathname = encodeURI(str);\r\n    };\r\n\r\n    app.url.setHash = function(str) {\r\n        win.location.hash = encodeURI(str);\r\n    };\r\n\r\n    app.url.setSearch = function(str) {\r\n        win.location.search = encodeURI(str);\r\n    };\r\n\r\n\r\n    /**\r\n     * 设置当前 URL hash search值\r\n     * @extends {Url}\r\n     * @param object\r\n     */\r\n    app.url.setHashSearch = function(object) {\r\n        var hashSearch = this.getHash(),\r\n            search = '',\r\n            hash = '',\r\n            obj = {},\r\n            i = 0,\r\n            key = null,\r\n            temp = null,\r\n            str = null,\r\n            arr = [],\r\n            hashArr = [];\r\n        if (/\\?/.test(hashSearch)) {\r\n            hashArr = hashSearch.split('?');\r\n            search = hashArr[1];\r\n            if (object.HASH) {\r\n                hash = object.HASH;\r\n                delete object.HASH;\r\n            } else {\r\n                hash = hashArr[0];\r\n            }\r\n\r\n\r\n            arr = search.split('&');\r\n\r\n            for (i = 0; i < arr.length; i++) {\r\n                temp = arr[i].split('=');\r\n                obj[temp[0]] = temp[1];\r\n            }\r\n            for (key in object) {\r\n                if (object.hasOwnProperty(key)) {\r\n                    obj[key] = object[key];\r\n                }\r\n            }\r\n            hash += '?';\r\n            for (str in obj) {\r\n                if (obj.hasOwnProperty(str)) {\r\n                    hash += (str + '=' + obj[str] + '&');\r\n                }\r\n            }\r\n            hash = hash.replace(/&$/, '');\r\n            app.url.setHash(hash);\r\n        } else {\r\n            if (object.HASH) {\r\n                hash = object.HASH;\r\n                delete object.HASH;\r\n            } else {\r\n                hash = hashSearch;\r\n            }\r\n\r\n            hash = hash + '?';\r\n            for (i in object) {\r\n                if (object.hasOwnProperty(i)) {\r\n                    hash = hash + i + '=' + object[i] + '&';\r\n                }\r\n            }\r\n            hash = hash.replace(/&$/, '');\r\n            app.url.setHash(hash);\r\n        }\r\n\r\n\r\n    };\r\n\r\n    app.url.delHashSearch = function(arg) {\r\n        var hashSearch = this.getHash(),\r\n            search = '',\r\n            hash = '',\r\n            obj = {},\r\n            i = 0,\r\n            key = null,\r\n            temp = null,\r\n            str = null,\r\n            arr = [],\r\n            hashArr = [];\r\n\r\n        hashArr = hashSearch.split('?');\r\n        search = hashArr[1];\r\n        hash = hashArr[0];\r\n        arr = search.split('&');\r\n\r\n        for (i = 0; i < arr.length; i++) {\r\n            temp = arr[i].split('=');\r\n            obj[temp[0]] = temp[1];\r\n        }\r\n\r\n        if (_.isArray(arg)) {\r\n            for (i = 0; i < arg.length; i++) {\r\n                if (obj[arg[i]]) {\r\n                    delete obj[arg[i]];\r\n                }\r\n            }\r\n        } else {\r\n            if (obj[arg]) {\r\n                delete obj[arg];\r\n            }\r\n        }\r\n        hash += '?';\r\n        for (str in obj) {\r\n            if (obj.hasOwnProperty(str)) {\r\n                hash += (str + '=' + obj[str] + '&');\r\n            }\r\n        }\r\n        hash = hash.replace(/&$/, '');\r\n        app.url.setHash(hash);\r\n    };\r\n\r\n\r\n    /**\r\n     * 格式化字符串url\r\n     * @param url\r\n     * @returns {{}}\r\n     */\r\n    app.url.parseUrl = function(url) {\r\n        var tmp, res = {},\r\n            p = null,\r\n            r = {\r\n                protocol: /([^\\/]+:)\\/\\/(.*)/i,\r\n                host: /(^[^\\:\\/]+)((?:\\/|:|$)?.*)/,\r\n                port: /\\:?([^\\/]*)(\\/?.*)/,\r\n                pathname: /([^\\?#]+)(\\??[^#]*)(#?.*)/\r\n            };\r\n        res.href = url;\r\n        for (p in r) {\r\n            if (r.hasOwnProperty(p)) {\r\n                tmp = r[p].exec(url);\r\n                res[p] = tmp ? tmp[1] : '';\r\n                url = tmp ? tmp[2] : '';\r\n                if (url === \"\") {\r\n                    url = \"/\";\r\n                }\r\n                if (p === \"pathname\") {\r\n                    res.pathname = tmp[1];\r\n                    res.search = tmp[2];\r\n                    res.hash = tmp[3];\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n\r\n    /**\r\n     * 比较两个域名是否相同\r\n     * @param i {String}    url 必须是合理的url，或者只是pathname,eq: http://www.e.com/sdf\r\n     * @param j {String}    url 必须是合理的url，或者只是pathname, eq: /sdfs/asdf/sdf?sdfsdf=123。有host必须带有protocol\r\n     * @param m {boolean}   是否判断端口、和协议\r\n     * @returns {boolean}\r\n     */\r\n    app.url.isEqualHost = function(i, j, m) {\r\n        var b = true,\r\n            iO = parseUrl(i),\r\n            jO = parseUrl(j);\r\n\r\n        iO.protocol = iO.protocol || win.location.protocol;\r\n        iO.host = iO.host || win.location.host;\r\n        iO.port = iO.port || win.location.port;\r\n        jO.protocol = jO.protocol || win.location.protocol;\r\n        jO.host = jO.host || win.location.host;\r\n        jO.port = jO.port || win.location.port;\r\n\r\n        // 针对localhost 处理\r\n        if (iO.host === '127.0.0.1') {\r\n            iO.host = 'localhost';\r\n        }\r\n        if (jO.host === '127.0.0.1') {\r\n            iO.host = 'localhost';\r\n        }\r\n\r\n        // 是否判断端口\r\n        if (m) {\r\n            b = iO.protocol === jO.protocol && iO.host === jO.host && iO.port === jO.port;\r\n        } else {\r\n            b = iO.host === jO.host;\r\n        }\r\n\r\n        return b;\r\n    };\r\n\r\n}(window, app));\r\n/**\r\n * @fileOverview\r\n * @author Crow\r\n * @version 0.0.1\r\n * @time 2015/7/23\r\n */\r\n\r\n/*global window, jQuery, app*/\r\n(function (win, $, app) {\r\n    'use strict';\r\n\r\n    /**\r\n     * @description 本地储存\r\n     * @constructor\r\n     */\r\n    var Stg = function () {\r\n        this.cookieExpires = 30;\r\n        this.isHasLocalStorage = win.localStorage || false;\r\n    };\r\n\r\n    /**\r\n     * @description 增加数据\r\n     * @param key\r\n     * @param str   必须是字符串\r\n     */\r\n    Stg.prototype.add = function (key, str) {\r\n        if (this.isHasLocalStorage) {\r\n            win.localStorage.setItem(key, str);\r\n        } else {\r\n            // cookie 目前只是简单的存储30天\r\n            $.cookie(key, str, {expires: this.cookieExpires});\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @description 目前根据key，获得数据\r\n     * @param key\r\n     * @return {*}\r\n     */\r\n    Stg.prototype.get = function (key) {\r\n        var result = null;\r\n        if (this.isHasLocalStorage) {\r\n            result = win.localStorage.getItem(key);\r\n        } else {\r\n            result = $.cookie(key);\r\n        }\r\n\r\n        // 处理 undefined\r\n        if (result === 'undefined') {\r\n            this.del(key);\r\n            result = null;\r\n        }\r\n\r\n        // TODO  临时处理\r\n        if (result == 'true' || result == 'false') {\r\n            return JSON.parse(result);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @description 目前根据key，删除数据\r\n     * @param key\r\n     */\r\n    Stg.prototype.del = function (key) {\r\n        if (this.isHasLocalStorage) {\r\n            win.localStorage.removeItem(key);\r\n        } else {\r\n            // cookie 暂时设置空，将在浏览器关闭时处理\r\n            $.cookie(key, '');\r\n        }\r\n    };\r\n\r\n    app.storage = new Stg();\r\n\r\n}(window, jQuery, app));"]}